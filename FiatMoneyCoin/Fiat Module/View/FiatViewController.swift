//
//  FiatViewController.swift
//  FiatMoneyCoin
//
//  Created tambanco ðŸ¥³ on 28.06.2022.
//
//  Template generated by Tambanco
//

import UIKit
import SnapKit

class FiatViewController: UIViewController {
	var presenter: FiatPresenterProtocol!
    var fiatTotalView: FiatTotalView!
//    var fiatTableView: UITableView!
    
//    @IBOutlet weak var fiatTotalView: UIView!
    @IBOutlet weak var addButton: UIButton!
    @IBOutlet weak var tableView: UITableView!
    @IBOutlet weak var totalValue: UILabel!
    @IBOutlet weak var earnValue: UILabel!
    @IBOutlet weak var earnPercent: UILabel!
    
	override func viewDidLoad() {
        super.viewDidLoad()
        setupTotalView()
//        setupTableView()
    }
    
    override func viewWillAppear(_ animated: Bool) {
        presenter.fetchCurrency()
    }
    
    @IBAction func addButton(_ sender: UIButton) {
        presenter.showCurrencyView()
    }
    
    func setupTotalView() {
        fiatTotalView = FiatTotalView(frame: CGRect(x: 0, y: 0, width: 0, height: 0))
        view.addSubview(fiatTotalView)
        
        fiatTotalView.snp.makeConstraints { make in
            make.top.equalTo(self.view.safeAreaLayoutGuide)
            make.leading.equalToSuperview().inset(0)
            make.trailing.equalToSuperview().inset(0)
            make.height.equalTo(225)
        }
//        fiatTotalView.layer.backgroundColor = Constants.backgroundColorView
//        fiatTotalView.layer.cornerRadius = 10
//        fiatTotalView.layer.masksToBounds = true
//        totalValue.text = "foo"
//        earnValue.text = "bar"
//        earnPercent.text = "baz"
        
    }
    
//    func setupTableView() {
//        fiatTableView = UITableView(frame: CGRect(x: 0, y: 0, width: 200, height: 200))
//        fiatTableView.register(FiatCell.self, forCellReuseIdentifier: FiatCell.reuseId)
//        fiatTableView.delegate = self
//        fiatTableView.dataSource = self
//        fiatTableView.separatorStyle = .none
//        fiatTableView.rowHeight = 100
//        fiatTableView.backgroundColor = .black
//
//        self.view.addSubview(fiatTableView)
//
//        fiatTableView.snp.makeConstraints { make in
//            make.top.equalTo(fiatTotalView.snp.bottom)
//            make.leading.equalToSuperview()
//            make.trailing.equalToSuperview()
//            make.bottom.equalTo(view.safeAreaInsets.bottom)
//        }
//    }
}

// MARK: - TableView
extension FiatViewController: UITableViewDelegate, UITableViewDataSource {
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        return presenter.fiatCurrencyList.count
    }
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        let cell = tableView.dequeueReusableCell(withIdentifier: FiatCell.reuseId, for: indexPath) as! FiatCell
        cell.currencyImage.image = UIImage(systemName: "dollarsign.circle.fill")
        cell.amountCurrency.text = presenter.fiatCurrencyList[indexPath.row].amountCurrency
        cell.amountCurrencySymbol.text = presenter.fiatCurrencyList[indexPath.row].amountCurrencySymbol
        cell.convertedValue.text = presenter.fiatCurrencyList[indexPath.row].convertedValue
        cell.earnPercent.text = String("0" + " " + "%")
        return cell
    }
}

// MARK: - Bindings
extension FiatViewController: FiatViewProtocol {
    func updateFiatView() {
        tableView.reloadData()
    }
}
